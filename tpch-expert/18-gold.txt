filter(exists(filter((sum_l_quantity > param1),
                select([l_orderkey, sum_l_quantity],
                  ahashidx(dedup(select([l_orderkey], lineitem)) as s5,
                    alist(select([sum_l_quantity],
                            filter((l_orderkey = s5.l_orderkey),
                              groupby([l_orderkey,
                                       sum(l_quantity) as sum_l_quantity],
                                [l_orderkey],
                                lineitem))) as s7,
                      atuple([ascalar(s7.sum_l_quantity)], cross)),
                    o1_orderkey)))),
  alist(orderby([o1_totalprice desc, o1_orderdate],
          groupby([c_name, c_custkey, o1_orderkey, o1_orderdate,
                   o1_totalprice, sum(l1_quantity) as tot_quantity],
            [c_name, c_custkey, o1_orderkey, o1_orderdate, o1_totalprice],
            join((c_custkey = o1_custkey),
              join((o1_orderkey = l1_orderkey),
                select([o_orderkey as o1_orderkey,
                        o_orderdate as o1_orderdate,
                        o_totalprice as o1_totalprice,
                        o_custkey as o1_custkey],
                  orders),
                select([l_orderkey as l1_orderkey, l_quantity as l1_quantity],
                  lineitem)),
              customer))) as s8,
    atuple([ascalar(s8.c_name), ascalar(s8.c_custkey),
            ascalar(s8.o1_orderkey), ascalar(s8.o1_orderdate),
            ascalar(s8.o1_totalprice), ascalar(s8.tot_quantity)],
      cross)))